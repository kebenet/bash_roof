#!/bin/bash

fn_add(){	# Add multiple files and commit msg

	# item=$(_first_uncommit_file)
	desc=$(_read-desc)
	shift
	git add "$@"
	git commit -m "$desc"

}

fn_all(){	# Auto Add files and commit msg

	fn_ls
	
	desc=$(_read-desc)
	git commit -a -m "$desc"

}

fn_single(){	# Add single file and commit
	local thefile="$2"

	item=$(_first_uncommit_file)
	[ -z "$item" ] && echo 'no uncommit file..' && exit 7
	[ ! -f "$thefile" ] && echo 'no file arg..' && exit 7

	desc=$(_read-desc)
	git add "$thefile"
	git commit -m "$desc"
}

fn_commit(){	# Add  commit msg only
	desc=$(_read-desc)
	git commit -m "$desc"
}


fn_ls(){	# list: uncommit files
	_is_gitdir
	git diff --name-only
}

fn_mv(){	# list: uncommit files
	_is_gitdir
	git "$1" "$2"
}


fn_lsu(){	# list: Untracked files
	git ls-files --others --exclude-standard
}

fn_branch(){	# get: current branch
	git branch
	git branch --show-current
}

_is_gitdir(){
	item=$(git status)
	[[ "$item" == fatal* ]]&& echo "Not in git dir.. Exit.." && exit 7
}

_first_uncommit_file(){
	git diff --name-only | sed -n '1p'
}

_read-desc(){
	set -e
	read -erp "Descriptions $ARROW " _desc
	[ -z "$_desc" ] && echo 'empty description..' && exit 7
	echo "$_desc"
}

"fn_$1" "$@"