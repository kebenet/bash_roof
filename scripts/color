#!/bin/sh

index=0
sep=':'

while getopts "f:i:" opt; do
  case ${opt} in
    f )
      sep=${OPTARG}
      shift 2
      ;;
    i )
      index=${OPTARG}
      shift 2
      ;;
    \? )
      echo "Invalid option: $OPTARG" 1>&2
      ;;
    : )
      echo "Invalid option: $OPTARG requires an argument" 1>&2
      ;;
  esac
done


clr(){

    awk -v sep="$sep" -v idx="$index" \
    'BEGIN {
        FS = (sep == "" ? ":" : sep);

        colors[3] = "\033[1;2m";
        colors[2] = "\033[1m";

        colors[4] = "\033[32m";
        colors[5] = "\033[1;30m"; # cyam
        colors[1] = "\033[36m";
        colors[6] = "\033[35m";
        colors[7] = "\033[33m";

        # colors[3] = "\033[1;38;2;0;0;0m"; # black
        }
        {
            str = ""
            for(i=1;i<=NF;i++){
                str = sprintf("%s%s%s\033[0m", str, colors[(i+idx) % 7 + 1], $i);
            }
            printf "%s\n", str;
        }'

}



#CODE! pipe is coming bro..
if [ -t 0 ]; then

    echo "$@" | clr "$sep"

else
    clr "$@"
    # echo 'pipe true'
fi

